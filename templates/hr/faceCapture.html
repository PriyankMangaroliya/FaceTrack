<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, shrink-to-fit=no" name="viewport">
    <title>FaceTrack - HR | Face Capture</title>

    <!-- CSS Files -->
    <link rel="stylesheet" href="{{ url_for('static', filename='assets/css/app.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='assets/bundles/datatables/datatables.min.css') }}">
    <link rel="stylesheet"
          href="{{ url_for('static', filename='assets/bundles/datatables/DataTables-1.10.16/css/dataTables.bootstrap4.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='assets/css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='assets/css/components.css') }}">
    <link rel="shortcut icon" href="{{ url_for('static', filename='assets/img/favicon.ico') }}">
    <style>
        .face-preview {
            width: 120px;
            height: 120px;
            object-fit: cover;
            border-radius: 8px;
            border: 2px solid #6c757d;
        }

        .camera-frame {
            border: 3px solid #28a745;
            border-radius: 8px;
            margin-top: 10px;
        }
    </style>
</head>

<body>
<div class="loader"></div>
<div id="app">
    <div class="main-wrapper main-wrapper-1">

        <!-- Sidebar -->
        {% include 'hr/sidebar.html' %}

        <!-- Main Content -->
        <div class="main-content">
            <section class="section">
                <div class="section-body">
                    <div class="container mt-4 text-center">

                        <h3 class="mb-3 text-dark font-weight-bold">
                            {% if action == "register" %}
                                üë§ Register Face for {{ user.name }}
                            {% else %}
                                üîÑ Update Face for {{ user.name }}
                            {% endif %}
                        </h3>

                        {% if old_images %}
                            <div class="mb-4">
                                <h6 class="text-muted">Previously Registered Faces:</h6>
                                <div class="d-flex flex-wrap">
                                    {% for img in old_images[:3] %}
                                        <img src="{{ url_for('static', filename=img.split('static/')[1]) }}"
                                             alt="Face Image"
                                             class="face-preview m-1 shadow-sm rounded border"
                                             style="width:100px;height:100px;object-fit:cover;">
                                    {% endfor %}
                                </div>
                            </div>
                        {% endif %}


                        <!-- Live Camera Feed -->
                        <div class="mt-3">
                            <h6 class="text-primary font-weight-bold">Live Camera Feed</h6>
                            <img src="{{ url_for('employee_users.video_feed') }}" width="400" height="300"
                                 class="camera-frame shadow">
                            <p class="text-muted mt-2">Ensure proper lighting and face visibility before capturing.</p>
                        </div>

                        <!-- Capture & Navigation Buttons -->
                        <div class="mt-4">
                            <a href="{{ url_for('employee_users.capture_face_action', user_id=user._id, action=action) }}"
                               class="btn btn-success btn-lg">
                                üì∏ Capture & Save
                            </a>
                            <a href="{{ url_for('employee_users.view_users') }}" class="btn btn-secondary btn-lg ml-2">
                                ‚Üê Back
                            </a>
                        </div>

                    </div>
                </div>
            </section>

            {% include 'hr/settings.html' %}
        </div>
    </div>
</div>

<!-- JS Files -->
<script src="{{ url_for('static', filename='assets/js/app.min.js') }}"></script>
<script src="{{ url_for('static', filename='assets/bundles/datatables/datatables.min.js') }}"></script>
<script src="{{ url_for('static', filename='assets/bundles/datatables/DataTables-1.10.16/js/dataTables.bootstrap4.min.js') }}"></script>
<script src="{{ url_for('static', filename='assets/js/page/datatables.js') }}"></script>
<script src="{{ url_for('static', filename='assets/js/scripts.js') }}"></script>
</body>
</html>
