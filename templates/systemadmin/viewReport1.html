<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta content="width=device-width, initial-scale=1, maximum-scale=1, shrink-to-fit=no" name="viewport" />
  <title>FaceTrack - Institute Report</title>

  <!-- CSS Files -->
  <link rel="stylesheet" href="../../static/assets/css/app.min.css" />
  <link rel="stylesheet" href="../../static/assets/css/style.css" />
  <link rel="stylesheet" href="../../static/assets/css/components.css" />
  <link rel="stylesheet" href="../../static/assets/css/custom.css" />
  <link rel="shortcut icon" type="image/x-icon" href="../../static/assets/img/favicon.ico" />

  <style>
    /* Styling for report sections */
    .report-section {
      margin-bottom: 40px;
    }

    .report-card {
      border: 1px solid #dee2e6;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      border-radius: 8px;
      margin-bottom: 35px;
    }

    .card-header h4 {
      font-weight: 600;
      color: #34395e;
    }

    .table th,
    .table td {
      vertical-align: middle !important;
      text-align: center;
    }

    .export-buttons a {
      margin-right: 8px;
    }

    .export-buttons .btn i {
      margin-right: 5px;
    }

    @media print {
      .btn,
      .form-group,
      .section-header,
      .section-header-breadcrumb,
      .export-buttons {
        display: none !important;
      }

      body {
        margin: 2cm;
      }
    }
  </style>
</head>

<body>
  <div class="loader"></div>
  <div id="app">
    <div class="main-wrapper main-wrapper-1">
      {% include 'systemadmin/sidebar.html' %}

      <!-- =================== MAIN CONTENT =================== -->
      <div class="main-content">
        <section class="section">
          <div class="section-header">
            <h1>Institute Report</h1>
          </div>

          <div class="section-body">
            <!-- =================== INSTITUTE SELECT FORM =================== -->
            <form method="get" action="{{ url_for('sa_reports.institute_report') }}" class="mb-4">
              <div class="form-group">
                <label for="institute_id"><strong>Select Institute:</strong></label>
                <div class="input-group">
                  <select name="institute_id" id="institute_id" class="form-control" required>
                    <option value="">-- Select Institute --</option>
                    {% for inst in institutes %}
                    <option value="{{ inst._id }}" {% if institute and inst._id == institute._id %}selected{% endif
                      %}>
                      {{ inst.name }}
                    </option>
                    {% endfor %}
                  </select>
                  <div class="input-group-append">
                    <button type="submit" class="btn btn-primary">View Report</button>
                  </div>
                </div>
              </div>
            </form>

            {% if institute %}
            <!-- =================== INSTITUTE DETAILS =================== -->
            <div class="report-card card report-section">
              <div class="card-header">
                <h4>Institute Details</h4>
                <div class="card-header-action export-buttons">
                  <a href="{{ url_for('sa_reports.institute_report', institute_id=institute._id, export='csv') }}"
                    class="btn btn-outline-primary"><i class="fas fa-file-csv"></i>CSV</a>
                  <a href="{{ url_for('sa_reports.institute_report', institute_id=institute._id, export='xlsx') }}"
                    class="btn btn-outline-success"><i class="fas fa-file-excel"></i>Excel</a>
                  <a href="{{ url_for('sa_reports.institute_report', institute_id=institute._id, export='pdf') }}"
                    class="btn btn-outline-danger"><i class="fas fa-file-pdf"></i>PDF</a>
                </div>
              </div>

              <div class="card-body">
                <div class="row">
                  <div class="col-md-6">
                    <p><strong>Name:</strong> {{ institute.name }}</p>
                    <p><strong>Type:</strong> {{ institute.institute_type or '—' }}</p>
                    <p><strong>Email:</strong> {{ institute.email or '—' }}</p>
                  </div>
                  <div class="col-md-6">
                    <p><strong>Address:</strong> {{ institute.address or '—' }}</p>
                    <p><strong>Institute ID:</strong> {{ institute._id }}</p>
                    <p><strong>Created At:</strong> {{ institute.created_at.strftime('%Y-%m-%d') if
                      institute.created_at else '—' }}</p>
                  </div>
                </div>
              </div>
            </div>

            <!-- =================== HR / ADMIN DETAILS =================== -->
            <div class="report-card card report-section">
              <div class="card-header bg-light">
                <h4>HR / Admin Users</h4>
              </div>
              <div class="card-body">
                {% if hr_list %}
                <div class="table-responsive">
                  <table class="table table-bordered table-striped">
                    <thead class="thead-light">
                      <tr>
                        <th>#</th>
                        <th>User ID</th>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Phone</th>
                        <th>Department</th>
                        <th>Designation</th>
                        <th>Status</th>
                      </tr>
                    </thead>
                    <tbody>
                      {% for hr in hr_list %}
                      <tr>
                        <td>{{ loop.index }}</td>
                        <td>{{ hr._id }}</td>
                        <td>{{ hr.name or '—' }}</td>
                        <td>{{ hr.email or '—' }}</td>
                        <td>{{ hr.phone or '—' }}</td>
                        <td>{{ hr.department or '—' }}</td>
                        <td>{{ hr.designation or '—' }}</td>
                        <td>{{ hr.status or 'Active' }}</td>
                      </tr>
                      {% endfor %}
                    </tbody>
                  </table>
                </div>
                {% else %}
                <p class="text-muted text-center">No HR/Admin users found for this institute.</p>
                {% endif %}
              </div>
            </div>

            <!-- =================== EMPLOYEE DETAILS =================== -->
            <div class="report-card card report-section">
              <div class="card-header bg-light">
                <h4>Employee Users</h4>
              </div>
              <div class="card-body">
                {% if employee_list %}
                <div class="table-responsive">
                  <table class="table table-bordered table-striped">
                    <thead class="thead-light">
                      <tr>
                        <th>#</th>
                        <th>User ID</th>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Phone</th>
                        <th>Department</th>
                        <th>Designation</th>
                        <th>Status</th>
                      </tr>
                    </thead>
                    <tbody>
                      {% for emp in employee_list %}
                      <tr>
                        <td>{{ loop.index }}</td>
                        <td>{{ emp._id }}</td>
                        <td>{{ emp.name or '—' }}</td>
                        <td>{{ emp.email or '—' }}</td>
                        <td>{{ emp.phone or '—' }}</td>
                        <td>{{ emp.department or '—' }}</td>
                        <td>{{ emp.designation or '—' }}</td>
                        <td>{{ emp.status or 'Active' }}</td>
                      </tr>
                      {% endfor %}
                    </tbody>
                  </table>
                </div>
                {% else %}
                <p class="text-muted text-center">No employee records found for this institute.</p>
                {% endif %}
              </div>
            </div>

            {% else %}
            <div class="alert alert-warning text-center">
              Please select an institute to view its report.
            </div>
            {% endif %}
          </div>
        </section>

        {% include 'systemadmin/settings.html' %}
      </div>
    </div>
  </div>

  <!-- JS Files -->
  <script src="../../static/assets/js/app.min.js"></script>
  <script src="../../static/assets/js/scripts.js"></script>
</body>

</html>
